{
  "info": {
    "_postman_id": "548ec072-55e9-4695-a52d-af31eb37ae4d",
    "name": "Restful-booker API Testing",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "_exporter_id": "52573507",
    "_collection_link": "https://go.postman.co/collection/52573507-548ec072-55e9-4695-a52d-af31eb37ae4d?source=collection_link"
  },
  "item": [
    {
      "name": "01 Health Check",
      "item": [
        {
          "name": "PING",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"API is up - Status 201\", function () {\r",
                  "    pm.response.to.have.status(201);\r",
                  "});\r",
                  "\r",
                  "pm.test(\"Response time is acceptable\", function () {\r",
                  "    pm.expect(pm.response.responseTime).to.be.below(3000);\r",
                  "});"
                ],
                "type": "text/javascript",
                "packages": {},
                "requests": {}
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/ping",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "ping"
              ]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "02 Auth",
      "item": [
        {
          "name": "CREATE TOKEN",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status is 200\", function () {\r",
                  "    pm.response.to.have.status(200);\r",
                  "});\r",
                  "\r",
                  "pm.test(\"Response contains token\", function () {\r",
                  "    var jsonData = pm.response.json();\r",
                  "    pm.expect(jsonData.token).to.exist;\r",
                  "    pm.expect(jsonData.token).to.be.a('string');\r",
                  "});\r",
                  "\r",
                  "// Guardar el token como variable de entorno\r",
                  "var jsonData = pm.response.json();\r",
                  "pm.environment.set(\"token\", jsonData.token);"
                ],
                "type": "text/javascript",
                "packages": {},
                "requests": {}
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\r\n    \"username\": \"admin\",\r\n    \"password\": \"password123\"\r\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/auth",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "auth"
              ]
            }
          },
          "response": []
        },
        {
          "name": "CREATE TOKEN WRONG",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status is 200\", function () {\r",
                  "    pm.response.to.have.status(200);\r",
                  "});\r",
                  "\r",
                  "pm.test(\"Response contains bad credentials message\", function () {\r",
                  "    var jsonData = pm.response.json();\r",
                  "    pm.expect(jsonData.reason).to.eql(\"Bad credentials\");\r",
                  "});"
                ],
                "type": "text/javascript",
                "packages": {},
                "requests": {}
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [],
            "body": {
              "mode": "raw",
              "raw": "{\r\n    \"username\": \"admin\",\r\n    \"password\": \"wrongpassword\"\r\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/auth",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "auth"
              ]
            }
          },
          "response": []
        }
      ],
      "auth": {
        "type": "basic",
        "basic": [
          {
            "key": "password",
            "value": "password123",
            "type": "string"
          },
          {
            "key": "username",
            "value": "admin",
            "type": "string"
          }
        ]
      },
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "packages": {},
            "requests": {},
            "exec": [
              ""
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "packages": {},
            "requests": {},
            "exec": [
              ""
            ]
          }
        }
      ]
    },
    {
      "name": "03 Get Bookings",
      "item": [
        {
          "name": "GET BOOKING IDs",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status is 200\", function () {\r",
                  "    pm.response.to.have.status(200);\r",
                  "});\r",
                  "\r",
                  "pm.test(\"Response is an array\", function () {\r",
                  "    var jsonData = pm.response.json();\r",
                  "    pm.expect(jsonData).to.be.an('array');\r",
                  "});\r",
                  "\r",
                  "pm.test(\"Each item contains bookingid\", function () {\r",
                  "    var jsonData = pm.response.json();\r",
                  "    jsonData.forEach(function (booking) {\r",
                  "        pm.expect(booking.bookingid).to.exist;\r",
                  "    });\r",
                  "});\r",
                  "\r",
                  "// Guardar el primer bookingid para usarlo en requests siguientes\r",
                  "var jsonData = pm.response.json();\r",
                  "pm.environment.set(\"booking_id\", jsonData[0].bookingid);"
                ],
                "type": "text/javascript",
                "packages": {},
                "requests": {}
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [],
            "url": {
              "raw": "{{base_url}}/booking",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "booking"
              ]
            }
          },
          "response": []
        },
        {
          "name": "GET BOOKING",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status is 200\", function () {\r",
                  "    pm.response.to.have.status(200);\r",
                  "});\r",
                  "\r",
                  "pm.test(\"Response contains required fields\", function () {\r",
                  "    var jsonData = pm.response.json();\r",
                  "    pm.expect(jsonData.firstname).to.exist;\r",
                  "    pm.expect(jsonData.lastname).to.exist;\r",
                  "    pm.expect(jsonData.totalprice).to.be.a('number');\r",
                  "    pm.expect(jsonData.depositpaid).to.be.a('boolean');\r",
                  "    pm.expect(jsonData.bookingdates).to.exist;\r",
                  "    pm.expect(jsonData.bookingdates.checkin).to.exist;\r",
                  "    pm.expect(jsonData.bookingdates.checkout).to.exist;\r",
                  "});\r",
                  "\r",
                  "pm.test(\"Booking dates format is valid\", function () {\r",
                  "    var jsonData = pm.response.json();\r",
                  "    pm.expect(jsonData.bookingdates.checkin).to.match(/^\\d{4}-\\d{2}-\\d{2}$/);\r",
                  "    pm.expect(jsonData.bookingdates.checkout).to.match(/^\\d{4}-\\d{2}-\\d{2}$/);\r",
                  "});"
                ],
                "type": "text/javascript",
                "packages": {},
                "requests": {}
              }
            }
          ],
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "Accept",
                "value": "application/json",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{base_url}}/booking/{{booking_id}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "booking",
                "{{booking_id}}"
              ]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "04 Create Booking",
      "item": [
        {
          "name": "CREATE BOOKING",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status is 200\", function () {\r",
                  "    pm.response.to.have.status(200);\r",
                  "});\r",
                  "\r",
                  "pm.test(\"Response contains bookingid\", function () {\r",
                  "    var jsonData = pm.response.json();\r",
                  "    pm.expect(jsonData.bookingid).to.exist;\r",
                  "    pm.expect(jsonData.bookingid).to.be.a('number');\r",
                  "});\r",
                  "\r",
                  "pm.test(\"Booking data matches request\", function () {\r",
                  "    var jsonData = pm.response.json();\r",
                  "    pm.expect(jsonData.booking.firstname).to.eql(\"Rodrigo\");\r",
                  "    pm.expect(jsonData.booking.lastname).to.eql(\"Flores\");\r",
                  "    pm.expect(jsonData.booking.totalprice).to.eql(500);\r",
                  "    pm.expect(jsonData.booking.depositpaid).to.be.true;\r",
                  "});\r",
                  "\r",
                  "// Guardar el nuevo bookingid para usarlo en Update y Delete\r",
                  "var jsonData = pm.response.json();\r",
                  "pm.environment.set(\"new_booking_id\", jsonData.bookingid);"
                ],
                "type": "text/javascript",
                "packages": {},
                "requests": {}
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\r\n    \"firstname\": \"Rodrigo\",\r\n    \"lastname\": \"Flores\",\r\n    \"totalprice\": 500,\r\n    \"depositpaid\": true,\r\n    \"bookingdates\": {\r\n        \"checkin\": \"2026-03-01\",\r\n        \"checkout\": \"2026-03-10\"\r\n    },\r\n    \"additionalneeds\": \"Breakfast\"\r\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/booking",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "booking"
              ]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "05 Update Booking",
      "item": [
        {
          "name": "UPDATE BOOKING",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status is 200\", function () {\r",
                  "    pm.response.to.have.status(200);\r",
                  "});\r",
                  "\r",
                  "pm.test(\"Booking was updated correctly\", function () {\r",
                  "    var jsonData = pm.response.json();\r",
                  "    pm.expect(jsonData.lastname).to.eql(\"Flores Agreda\");\r",
                  "    pm.expect(jsonData.totalprice).to.eql(750);\r",
                  "    pm.expect(jsonData.depositpaid).to.be.false;\r",
                  "    pm.expect(jsonData.additionalneeds).to.eql(\"Breakfast and dinner\");\r",
                  "});\r",
                  "\r",
                  "pm.test(\"Updated dates are correct\", function () {\r",
                  "    var jsonData = pm.response.json();\r",
                  "    pm.expect(jsonData.bookingdates.checkin).to.eql(\"2026-03-05\");\r",
                  "    pm.expect(jsonData.bookingdates.checkout).to.eql(\"2026-03-15\");\r",
                  "});"
                ],
                "type": "text/javascript",
                "packages": {},
                "requests": {}
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              },
              {
                "key": "Accept",
                "value": "application/json",
                "type": "text"
              },
              {
                "key": "Cookie",
                "value": "token={{token}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\r\n    \"firstname\": \"Rodrigo\",\r\n    \"lastname\": \"Flores Agreda\",\r\n    \"totalprice\": 750,\r\n    \"depositpaid\": false,\r\n    \"bookingdates\": {\r\n        \"checkin\": \"2026-03-05\",\r\n        \"checkout\": \"2026-03-15\"\r\n    },\r\n    \"additionalneeds\": \"Breakfast and dinner\"\r\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/booking/{{new_booking_id}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "booking",
                "{{new_booking_id}}"
              ]
            }
          },
          "response": []
        },
        {
          "name": "PARTIAL UPDATE BOOKING",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status is 200\", function () {\r",
                  "    pm.response.to.have.status(200);\r",
                  "});\r",
                  "\r",
                  "pm.test(\"Partial update was applied correctly\", function () {\r",
                  "    var jsonData = pm.response.json();\r",
                  "    pm.expect(jsonData.firstname).to.eql(\"Rodrigo Jesus\");\r",
                  "    pm.expect(jsonData.totalprice).to.eql(900);\r",
                  "});\r",
                  "\r",
                  "pm.test(\"Non-updated fields remain unchanged\", function () {\r",
                  "    var jsonData = pm.response.json();\r",
                  "    pm.expect(jsonData.lastname).to.eql(\"Flores Agreda\");\r",
                  "    pm.expect(jsonData.additionalneeds).to.eql(\"Breakfast and dinner\");\r",
                  "});"
                ],
                "type": "text/javascript",
                "packages": {},
                "requests": {}
              }
            }
          ],
          "request": {
            "method": "PATCH",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              },
              {
                "key": "Accept",
                "value": "application/json",
                "type": "text"
              },
              {
                "key": "Cookie",
                "value": "token={{token}}",
                "type": "text"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\r\n    \"firstname\": \"Rodrigo Jesus\",\r\n    \"totalprice\": 900\r\n}",
              "options": {
                "raw": {
                  "language": "json"
                }
              }
            },
            "url": {
              "raw": "{{base_url}}/booking/{{new_booking_id}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "booking",
                "{{new_booking_id}}"
              ]
            }
          },
          "response": []
        }
      ],
      "auth": {
        "type": "basic",
        "basic": [
          {
            "key": "password",
            "value": "password123",
            "type": "string"
          },
          {
            "key": "username",
            "value": "admin",
            "type": "string"
          }
        ]
      },
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "packages": {},
            "requests": {},
            "exec": [
              ""
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "packages": {},
            "requests": {},
            "exec": [
              ""
            ]
          }
        }
      ]
    },
    {
      "name": "06 Delete Booking",
      "item": [
        {
          "name": "New Request",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "pm.test(\"Status is 201\", function () {\r",
                  "    pm.response.to.have.status(201);\r",
                  "});\r",
                  "\r",
                  "pm.test(\"Booking was deleted\", function () {\r",
                  "    pm.expect(pm.response.text()).to.include(\"Created\");\r",
                  "});"
                ],
                "type": "text/javascript",
                "packages": {},
                "requests": {}
              }
            }
          ],
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json",
                "type": "text"
              },
              {
                "key": "Cookie",
                "value": "token={{token}}",
                "type": "text"
              }
            ],
            "url": {
              "raw": "{{base_url}}/booking/{{new_booking_id}}",
              "host": [
                "{{base_url}}"
              ],
              "path": [
                "booking",
                "{{new_booking_id}}"
              ]
            }
          },
          "response": []
        }
      ],
      "auth": {
        "type": "basic",
        "basic": [
          {
            "key": "password",
            "value": "password123",
            "type": "string"
          },
          {
            "key": "username",
            "value": "admin",
            "type": "string"
          }
        ]
      },
      "event": [
        {
          "listen": "prerequest",
          "script": {
            "type": "text/javascript",
            "packages": {},
            "requests": {},
            "exec": [
              ""
            ]
          }
        },
        {
          "listen": "test",
          "script": {
            "type": "text/javascript",
            "packages": {},
            "requests": {},
            "exec": [
              ""
            ]
          }
        }
      ]
    }
  ]
}